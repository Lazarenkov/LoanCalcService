# LoanCalcService

Тренировочный проект по java-разработке.

##### Бизнес-описание
Кредитный калькулятор, позволяющий рассчитать аннуитетные или дифференцированные платежи, с учетом страхования и сформировать график платежей.
В качестве входных данных используются сумма кредита, срок, ставка, условия расчета страхования, страховой коэффициент и дата выдачи кредита.
Дни платежей в графике равны дню даты выдачи кредита. Если день попадает на выходной, то переносится на следующий ближайший рабочий.
Калькуляция с учетом страхования возможна в двух вариантах:
- страховка прибавляется к сумме кредита, но не учитывается при расчете платежей (аналог ситуации, когда страховка уплачивается клиентом самостоятельно из собственных средств)
- страховка включается в сумму кредита и учитывается при расчете платежей (аналог ситуации, когда страховка уплачивается из кредитных средств, тело кредита увеличивается на размер страхового платежа, из расчета, что после ее уплаты клиент получит "на руки" изначально интересующую его сумму)

##### Техническое описание
###### Режимы
Приложение может быть запущено в консольном режиме или в режиме веб-сервера:
- в консольном режиме ввод и вывод осуществляются посредством консоли.
- в режиме веб-сервера - посредством HTTP-запросов к REST-API. Для обмена используется JSON.
###### Сборка
Сборка посредством стандартных средств Maven
```
mvn clean package
```

К проекту приложена готовая для- запуска сборка [jar-файла](LoanCalcService.jar).
###### СУБД
Приложение может использовать СУБД для уникального хранения результатов выполненных расчетов и дополнительного функционала.
Для работы необходима СУБД PostgreSQL c базой данных "calc". Создание БД стандартными средствами SQL:

```sql
CREATE TABLESPACE calc LOCATION '--path to tablespace--';

CREATE USER "main" WITH PASSWORD 'password';

CREATE DATABASE "calc" WITH OWNER="main" TEMPLATE=DEFAULT ENCODING='UNICODE';
```

Можно использовать иную базу данных. Для этого необходимо поправить параметры подключения в файле hibernate.cfg.xml
Приложение работает в схеме "public".

###### Запуск
Для работы приложения необходима установленная Java 17 или выше.
Поместите jar-архив в любую удобную папку на компьютере.
Jar-архив запускается стандартно, через вызов java.exe (в среде Windows).
**Параметры запуска:**
- первый параметр ("MODE") - режим запуска: "=CONSOLE" или "=HTTP"
- второй параметр ("PORT") - порт, используемый при работе в режиме веб-сервера
- третий параметр ("DB") - использование СУБД: "=TRUE" или "=FALSE"

Пример команды запуска в режиме консоли без использования БД:
```
java -jar LoanCalcService.jar MODE=CONSOLE DB=false
```

Пример команды запуска в режиме веб-сервера на порту 8000 с использованием БД:
```
java -jar LoanCalcService.jar MODE=HTTP PORT=8000 DB=true
```

###### Взаимодействие
В консольном режиме следуйте инструкциям, которые выводит приложение на консоль.
Часть функционала по работе с БД в этом режиме недоступна.

В режиме-веб сервера взаимодействуйте с приложением посредством HTTP-запросов к REST-API. Описание API находится в приложенном к проекту файле [Swagger](swagger.yaml).
К проекту приложена [Postman-коллекция](LoanCalcService.postman_collection.json) с готовыми образцами запросов.

###### Стек
Использованы:
- Java Core
    - Annotations
    - ReflectionAPI
    - Generics
    - CRUD
    - Interfaces
    - Enum
    - etc
- Maven
- Hibernate
- Log4j2
- com.sun.net
- Jackson Databind
- JUnit5
- PostgreSQL